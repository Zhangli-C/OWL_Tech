(function(){
  const I18N = {
    zh: {
      companyName: "南京遨迩科技有限公司",
      tagline: "专注气象雷达与光电探测技术",
      navHome: "首页",
      navProducts: "产品",
      navAbout: "公司简介",
      navContact: "联系我们",
      ctaProducts: "查看产品",
      ctaContact: "联系合作",
      heroKicker: "Weather Radar • Optoelectronics • System Integration",
      heroTitle: "面向智慧气象的雷达与光电技术方案",
      heroSub: "聚焦雷达信号处理、嵌入式/FPGA开发、仪器仪表研发与信息系统集成，为气象监测、科研与工程项目提供可靠的产品与解决方案。",
      stat1T: "核心能力",
      stat1S: "雷达/光电/通信系统研发与集成",
      stat2T: "交付方向",
      stat2S: "气象监测、科研试验、工程部署",
      stat3T: "服务模式",
      stat3S: "方案咨询 • 研发定制 • 系统集成",
      secBiz: "核心业务",
      f1T: "气象雷达系统",
      f1P: "包含雷达前端、信号处理、数据链路与平台软件，支持工程部署与定制化开发。",
      f2T: "光电探测与测量",
      f2P: "光电传感与测量系统设计与集成，面向环境监测、目标探测与科研场景。",
      f3T: "通信与信息系统集成",
      f3P: "软硬件研发、数据接口与系统集成服务，支持端到端交付。",
      secProducts: "产品展示",
      p1B: "Radar",
      p1T: "X波段/Ku波段气象雷达（示例）",
      p1P: "用于降水、风场与回波监测的雷达系统方案，可按项目需求定制。",
      p1L1: "发射/接收与射频前端",
      p1L2: "信号处理与数据链路",
      p1L3: "平台软件与接口对接",
      p2B: "Module",
      p2T: "雷达信号处理模块（FPGA/DSP）",
      p2P: "面向高速采集与实时处理的算法与硬件实现。",
      p2L1: "脉冲压缩/多普勒处理",
      p2L2: "目标检测与杂波抑制",
      p2L3: "上位机与接口协议",
      p3B: "Platform",
      p3T: "气象数据平台与可视化（示例）",
      p3P: "支持数据接入、存储、质控、展示与API对接。",
      p3L1: "地图/回波可视化",
      p3L2: "数据服务与权限管理",
      p3L3: "系统集成与运维支持",
      secAbout: "公司简介",
      aboutP1: "南京遨迩科技有限公司专注于气象雷达、光电技术与通信系统集成，面向智慧气象、应急管理与科研单位提供产品与解决方案。",
      aboutP2: "公司经营范围覆盖电子/安防/光电/通信技术开发与技术服务、仪器仪表与电子元器件研发销售、计算机软硬件研发销售及信息系统集成服务。",
      secContact: "联系我们",
      contactP: "欢迎交流合作需求（项目咨询、联合研发、系统集成）。",
      fieldAddr: "地址",
      fieldEmail: "邮箱",
      fieldPhone: "电话",
      fieldMsg: "留言",
      footer: "© 2026 南京遨迩科技有限公司"
    },
    en: {
      companyName: "Nanjing OWL Technology Co., Ltd.",
      tagline: "Weather Radar & Optoelectronics Solutions",
      navHome: "Home",
      navProducts: "Products",
      navAbout: "About",
      navContact: "Contact",
      ctaProducts: "View Products",
      ctaContact: "Contact Us",
      heroKicker: "Weather Radar • Optoelectronics • System Integration",
      heroTitle: "Radar & Optoelectronics for Smart Meteorology",
      heroSub: "We focus on radar signal processing, embedded/FPGA development, instrumentation R&D, and system integration—delivering products and solutions for meteorological monitoring, research, and engineering deployments.",
      stat1T: "Capabilities",
      stat1S: "Radar / Optoelectronics / Communications",
      stat2T: "Applications",
      stat2S: "Meteorology, research trials, field deployments",
      stat3T: "Services",
      stat3S: "Consulting • Custom R&D • Integration",
      secBiz: "Core Business",
      f1T: "Weather Radar Systems",
      f1P: "End-to-end radar solutions including RF front-end, processing, data link, and software platform—customizable for projects.",
      f2T: "Optoelectronic Sensing",
      f2P: "Design and integration of sensing & measurement systems for monitoring, detection, and research scenarios.",
      f3T: "Comms & System Integration",
      f3P: "Hardware/software R&D, data interfaces, and integration services for turnkey delivery.",
      secProducts: "Product Showcase",
      p1B: "Radar",
      p1T: "X/Ku-band Weather Radar (Sample)",
      p1P: "Configurable radar system solution for precipitation, wind field, and echo monitoring.",
      p1L1: "RF front-end and transceiver",
      p1L2: "Signal processing & data link",
      p1L3: "Software platform & integration",
      p2B: "Module",
      p2T: "Signal Processing Module (FPGA/DSP)",
      p2P: "Algorithms and hardware implementation for high-speed acquisition and real-time processing.",
      p2L1: "Pulse compression / Doppler",
      p2L2: "Detection & clutter suppression",
      p2L3: "Host software & protocols",
      p3B: "Platform",
      p3T: "Meteorological Data Platform & Visualization (Sample)",
      p3P: "Data ingestion, storage, QC, visualization, and API integration.",
      p3L1: "Map & echo visualization",
      p3L2: "Data services & access control",
      p3L3: "Integration & maintenance",
      secAbout: "About Us",
      aboutP1: "Nanjing OWL Technology Co., Ltd. focuses on weather radar, optoelectronics, and communications integration, providing products and solutions for smart meteorology, emergency management, and research institutions.",
      aboutP2: "Our business scope includes electronics/security/optoelectronics/communications technology development and services, instrumentation and components R&D and sales, software/hardware development, and information system integration.",
      secContact: "Contact",
      contactP: "Let’s discuss cooperation (project consulting, joint R&D, system integration).",
      fieldAddr: "Address",
      fieldEmail: "Email",
      fieldPhone: "Phone",
      fieldMsg: "Message",
      footer: "© 2026 Nanjing OWL Technology Co., Ltd."
    }
  };

  function getLang(){
    const saved = localStorage.getItem("lang");
    if(saved === "en" || saved === "zh") return saved;
    const nav = (navigator.language || "").toLowerCase();
    return nav.startsWith("zh") ? "zh" : "en";
  }

  function setLang(lang){
    localStorage.setItem("lang", lang);
    applyLang(lang);
  }

  function applyLang(lang){
    const dict = I18N[lang] || I18N.zh;

    // 替换所有带 data-i18n="key" 的元素
    document.querySelectorAll("[data-i18n]").forEach(el=>{
      const key = el.getAttribute("data-i18n");
      if(dict[key] !== undefined) el.textContent = dict[key];
    });

    // 替换带 data-i18n-html="key"（需要保留HTML时）
    document.querySelectorAll("[data-i18n-html]").forEach(el=>{
      const key = el.getAttribute("data-i18n-html");
      if(dict[key] !== undefined) el.innerHTML = dict[key];
    });

    // 高亮当前页面菜单
    const path = (location.pathname.split("/").pop() || "index.html").toLowerCase();
    document.querySelectorAll(".menu a").forEach(a=>{
      const href = (a.getAttribute("href") || "").toLowerCase();
      a.classList.toggle("active", href === path || (path === "" && href === "index.html"));
    });

    // 切换按钮状态
    const toggle = document.getElementById("langToggle");
    if(toggle){
      toggle.textContent = (lang === "zh") ? "EN" : "中文";
      toggle.setAttribute("aria-label", (lang === "zh") ? "Switch to English" : "切换到中文");
    }

    document.documentElement.lang = (lang === "zh") ? "zh-CN" : "en";
  }

  window.__OWL_LANG__ = { getLang, setLang };

  document.addEventListener("DOMContentLoaded", ()=>{
    const lang = getLang();
    applyLang(lang);

    const toggle = document.getElementById("langToggle");
    if(toggle){
      toggle.addEventListener("click", ()=>{
        const cur = getLang();
        setLang(cur === "zh" ? "en" : "zh");
      });
    }
  });
})();
